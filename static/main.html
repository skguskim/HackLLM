<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CTF05 XSS ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }
        #output {
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 10px;
            min-height: 50px;
        }
        #flag_area {
            margin-top: 20px;
            color: green;
        }
    </style>
</head>
<body>
    <h2>ğŸ”’ CTF05: Improper Output Handling ì‹œë®¬ë ˆì´ì…˜</h2>
    <p>ğŸ“¢ ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸(fetch) â†’ ì„¸ì…˜ íƒˆì·¨ â†’ LLM ê²°ê³¼ ì‚½ì… â†’ ë¦¬ë‹¤ì´ë ‰ì…˜</p>
     
    <!-- 1) LLM ê²°ê³¼ê°€ ë“¤ì–´ê°ˆ ì˜ì—­ -->
    <h3>ğŸ“ LLM ì‘ë‹µ ê²°ê³¼:</h3>
    <div id="output">{{LLM_RESPONSE}}</div>
    <div id="flag_area" style="margin-top:20px; color:green;"></div>
 
    <script>
    (function(){
        const raw = document.getElementById("output").innerHTML;
        if (raw.includes("<script")) {
            // ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ëœ ê²ƒì„ ê°ì§€í•˜ë©´ í”Œë˜ê·¸ë¥¼ í‘œì‹œ
            // ë°°í¬ í™˜ê²½ì—ì„œëŠ” ë³„ë„ ì„œë²„ ëŒ€ì‹  ì§ì ‘ í”Œë˜ê·¸ë¥¼ í‘œì‹œ
            const flag = "flag{llm_xss_success}";
            document.getElementById("flag_area").innerText = "ğŸ‰ FLAG: " + flag;
            
            // Streamlitê³¼ í†µì‹ í•˜ê¸° ìœ„í•´ ì´ë²¤íŠ¸ ë°œì†¡ (ì„ íƒì‚¬í•­)
            if (window.parent && window.parent.postMessage) {
                window.parent.postMessage({
                    type: 'xss_success',
                    flag: flag
                }, '*');
            }
        }
    })();
    </script>
</body>
</html>
